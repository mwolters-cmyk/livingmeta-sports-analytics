{
  "_about": "Complete protocol for AI agents to perform and contribute research gap analyses on the Living Sports Analytics platform. Follow these steps in order. The platform uses Claude Haiku internally for the same purpose — this protocol teaches external agents to do the same work independently.",

  "when_to_use_this": "You found the Living Sports Analytics platform, searched for papers on your user's topic, and discovered that NO existing gap analysis covers their question (check /api/gaps/index.json). You found ≥5 relevant papers. Your user would benefit from a structured synthesis of what's known, what's missing, and what to research next.",

  "how_the_platform_does_it_internally": {
    "model": "Claude Haiku 4.5 (claude-haiku-4-5-20251001)",
    "cost_per_analysis": "$0.05-0.15",
    "approach": "Two-phase: (A) pure Python retrieval + context building from 13,800+ classified papers, (B) structured Claude Haiku call with intellectual honesty rules. The system prompt enforces: only cite provided papers, flag database coverage gaps, use confidence levels everywhere, do not hallucinate.",
    "why_we_share_this": "We want external agents to produce analyses at the same quality bar. The more gap analyses exist, the more valuable the platform becomes for everyone."
  },

  "protocol": {
    "phase_1_gather_papers": {
      "title": "Phase 1: Gather Papers from the Platform",
      "description": "Download the compact search index and filter for relevant papers. This is the equivalent of our internal Phase A.",
      "steps": [
        {
          "step": 1,
          "action": "Fetch /api/papers-compact.json (~4MB)",
          "details": "This contains ALL 13,800+ classified papers in array-of-arrays format. Fields in order: [work_id, title, sport, methodology, theme, pub_year, cited_by_count, first_author, doi, content_type, sub_theme]. The work_id is a short ID like 'W4406017810' — the full OpenAlex URL is https://openalex.org/{work_id}.",
          "tip": "If your tool cannot handle 4MB JSON, use the /papers page with URL params for manual filtering: /papers?search=<keyword>&sport=<sport>&methodology=<methodology>"
        },
        {
          "step": 2,
          "action": "Filter papers using multiple search strategies",
          "details": "Search broadly — papers may be relevant even if the exact keyword doesn't appear. Use OR logic across keywords, AND logic between categories.",
          "search_strategies": [
            "Title keyword matching (case-insensitive substring)",
            "Sport filter (field index 2): use values from /api/pipeline.json → classification_taxonomy.sports",
            "Methodology filter (field index 3): e.g. 'statistical', 'machine_learning', 'meta_analysis'",
            "Theme filter (field index 4): e.g. 'performance_analysis', 'coaching', 'player_valuation'",
            "Sub-theme filter (field index 10): more specific topic tags like 'managerial impact', 'home advantage'"
          ],
          "example": "For coach dismissal in football: filter sport='football', then search titles for any of: 'coach', 'manager', 'dismissal', 'firing', 'sacking', 'turnover', 'succession', 'leadership', 'managerial'. Also check theme='coaching' and sub_theme containing 'managerial'."
        },
        {
          "step": 3,
          "action": "Enrich with full metadata if needed",
          "details": "For the papers you found, you can get full metadata (abstracts, AI summaries, impact metrics) from /api/classifications.json. WARNING: this file is ~16MB. If you only need a few papers, use the /papers page: /papers?paper=https://openalex.org/{work_id}",
          "minimum_papers": 5,
          "ideal_papers": "15-60 for a solid gap analysis. More than 100 makes synthesis difficult."
        },
        {
          "step": 4,
          "action": "Check for available datasets",
          "details": "Fetch /api/data-sources.json to find datasets relevant to your topic. This helps you suggest concrete data sources in the research agenda.",
          "tip": "Filter by sport tag matching your topic. Resources with access_via != null have programmatic access instructions."
        },
        {
          "step": 5,
          "action": "Check existing gap analyses for overlap",
          "details": "Fetch /api/gaps/index.json. If a related (but not identical) gap analysis exists, fetch the full version at /api/gaps/<slug>.json. Reference it in your analysis — build on existing work, don't duplicate it.",
          "tip": "Even if the topic differs, a related gap analysis may reference papers relevant to your analysis."
        }
      ]
    },

    "phase_2_analyze": {
      "title": "Phase 2: Synthesize and Identify Gaps",
      "description": "Now analyze the papers you gathered. This is the equivalent of our internal Phase B, where Claude Haiku produces the structured analysis. You are the AI doing this work.",

      "intellectual_honesty_rules": {
        "_importance": "These rules are what makes our gap analyses trustworthy. They are non-negotiable.",
        "rules": [
          "ONLY the papers you found on the platform are your evidence. You may NOT make factual claims based on your training knowledge alone.",
          "Every claim MUST cite specific papers. Never make unsupported assertions.",
          "'Not in the database' ≠ 'not studied'. Absence from this platform's 13,800+ papers does not mean the topic has never been studied — it means we have no evidence of it in this collection.",
          "If you suspect relevant work exists outside this database (from your general training knowledge), flag this explicitly in self_reflection.coverage_gaps. For example: 'The database appears to lack papers by Van Ours and colleagues on coach dismissal effects, even though this is an established research area in sports economics.' This is a VALUABLE finding.",
          "Use confidence levels (high/medium/low) for EVERY gap and finding.",
          "Do NOT hallucinate papers or citations. Only reference papers you actually found on the platform.",
          "If the research question is too broad, too narrow, or poorly defined, say so honestly in scope_assessment.",
          "Consider the qualitative/mixed-methods blind spot: sports analytics is overwhelmingly quantitative. Are there questions here that REQUIRE qualitative evidence?"
        ]
      },

      "what_to_produce": {
        "sections": [
          {
            "name": "scope",
            "purpose": "Define and critically assess the research question",
            "key_question": "Is this question well-scoped for a gap analysis? Too broad? Too narrow?"
          },
          {
            "name": "database_coverage",
            "purpose": "Quantify what the platform has on this topic",
            "key_question": "How many papers? What methodologies? What time period? Which sports?"
          },
          {
            "name": "research_landscape",
            "purpose": "Synthesize what IS known — the state of the art",
            "key_question": "What do the papers collectively tell us? Where do they agree? Disagree?",
            "tip": "This is the hardest part. Most papers are 'monologues' — they rarely engage with each other. Your job is to create the dialogue they failed to have."
          },
          {
            "name": "gaps",
            "purpose": "Identify what is NOT known — the actual gaps",
            "key_question": "What specific questions remain unanswered? What populations/methods/data are missing?",
            "gap_types": ["methodological", "population", "temporal", "conceptual", "measurement", "contextual", "applied"],
            "target": "5-10 specific, actionable gaps (not generic 'more research needed')"
          },
          {
            "name": "research_agenda",
            "purpose": "Propose concrete research projects that address the gaps",
            "key_question": "What should a student/researcher actually DO? Be specific enough that someone can start from this.",
            "levels": ["BSc", "MSc", "PhD", "any"],
            "tip": "Reference available datasets from /api/data-sources.json. A gap analysis that says 'use FBref data for a difference-in-differences analysis across 10 European leagues' is 10x more useful than 'future research should investigate this topic'."
          },
          {
            "name": "self_reflection",
            "purpose": "Critically assess your own analysis",
            "key_question": "What are your limitations? What's missing? How confident are you?",
            "tip": "This section is what separates good from great gap analyses. Be brutally honest."
          }
        ]
      }
    },

    "phase_3_submit": {
      "title": "Phase 3: Format and Submit",
      "description": "Format your analysis according to the schema and submit it.",
      "steps": [
        {
          "step": 1,
          "action": "Format as JSON following /api/contribute/gap-analysis-schema.json",
          "details": "The schema defines all required fields, enums, and types. Validate your JSON against it."
        },
        {
          "step": 2,
          "action": "Create a GitHub Issue",
          "url": "https://github.com/mwolters-cmyk/living-sports-analytics-research/issues",
          "title_format": "Gap Analysis: <your descriptive title>",
          "label": "gap-analysis",
          "body": "Paste the full JSON as the issue body. Add a brief human-readable summary at the top (2-3 sentences about the question, how many papers you analyzed, and the most important gap you found)."
        },
        {
          "step": 3,
          "action": "Wait for review",
          "details": "The platform maintainer reviews all submissions before publication. Typical review time: 1-2 weeks. You and your user will be credited on the published analysis.",
          "quality_bar": "We accept analyses that: (1) analyze ≥5 papers from the platform, (2) follow the intellectual honesty rules, (3) identify specific actionable gaps (not generic statements), (4) include honest self-reflection about limitations."
        }
      ]
    }
  },

  "understanding_the_platform_pipeline": {
    "_why": "Understanding how the platform works helps you write better gap analyses and contribute more effectively.",

    "how_papers_get_classified": {
      "source": "Papers come from two sources: (1) OpenAlex API — monitors 28 academic journals + keyword queries weekly, (2) Non-OA sources — blog posts, theses, conference papers ingested via scripts/ingest_source.py",
      "classification": "Every paper is classified by Claude Haiku 4.5 on three dimensions: sport (33 categories), methodology (13 categories), theme (17 categories). Each paper also gets a relevance score (1-10). Only papers scoring ≥5 on sports_analytics relevance appear on the website.",
      "taxonomy_reference": "/api/pipeline.json → classification_taxonomy (the complete list of valid categories)",
      "implication_for_agents": "When you search the platform, you're searching papers that passed an AI quality gate. But this also means: papers that are tangentially related (relevance 1-4) are excluded. Your topic might be better covered in the full academic literature than what appears here."
    },

    "how_papers_get_enriched": {
      "extraction": "After classification, papers with PDFs or abstracts are analyzed by Claude Haiku to extract: study design, sample size, key statistical methods, data sources used, key results, limitations, and future research directions. This structured data is what powers the /methodology page and the platform's gap analyses.",
      "what_you_get": "Via /api/classifications.json you get: title, abstract, AI-generated summary, sport/methodology/theme classification, citation count, FWCI (field-weighted citation impact), journal metrics. Via the /papers page you get a visual browser with filters."
    },

    "available_data_sources": {
      "what": "The platform catalogs 733+ data sources, tools, and libraries used in sports analytics research. 128 have programmatic access instructions.",
      "endpoint": "/api/data-sources.json",
      "how_to_use": "When writing the research_agenda section of your gap analysis, check whether relevant datasets already exist. Mentioning 'FBref league data via their API' or 'Kaggle European Soccer Database' makes your proposed research project immediately more actionable.",
      "scraper_contribution": "If a dataset you recommend lacks programmatic access, you can also contribute a scraper. See /api/pipeline.json → scraper_contribution for the template and PR checklist."
    },

    "feeds_and_sources": {
      "what": "The platform actively monitors 50+ content sources (RSS feeds, sitemaps, thesis repositories, conference proceedings) for new sports analytics content.",
      "endpoint": "/feeds page or /api/pipeline.json → collection_methods",
      "implication": "The database grows every week. A gap you identify today might be partially filled next month as new papers arrive."
    }
  },

  "help_the_platform_grow": {
    "_why": "While analyzing papers, you may discover that the platform is missing papers, classifications, or full-text extractions that would be valuable. This is not just a limitation of your analysis — it's an opportunity to make the platform better for everyone. We actively want agents to report these gaps.",

    "report_missing_papers": {
      "when": "You found important papers via web search or your training knowledge that are NOT in the platform database (not in papers-compact.json). For example: the Volkskrant article references Jan van Ours's work, but his papers don't appear in the platform.",
      "how": "Create a GitHub Issue with title 'Missing Papers: <topic>' and label 'missing-papers'",
      "format": {
        "title": "Missing Papers: Coach dismissal effects in football",
        "papers": [
          {
            "title": "In-season Head-Coach Dismissals and the Performance of Professional Football Teams",
            "authors": "van Ours, J.C. & van Tuijl, M.A.",
            "year": 2016,
            "doi": "10.1111/ecoj.12375",
            "journal": "The Economic Journal",
            "why_relevant": "Seminal paper on coach dismissal effects with counterfactual analysis across 4 leagues"
          }
        ],
        "context": "These papers are important for a gap analysis on coach dismissal effects. They represent a blind spot in the platform's sports economics coverage."
      },
      "what_happens": "The maintainer adds these papers to the OpenAlex watcher or ingests them manually. They get classified and extracted within 1-2 weeks."
    },

    "request_classification_or_extraction": {
      "when": "You found papers IN the platform database (they appear in papers-compact.json) but they lack full metadata — no abstract, no AI summary, no methodology extraction. This limits your gap analysis because you only have a title and basic metadata.",
      "how": "Create a GitHub Issue with title 'Extraction Request: <topic>' and label 'extraction-request'",
      "format": {
        "title": "Extraction Request: Coach dismissal papers need full extraction",
        "work_ids": ["https://openalex.org/W4391234567", "https://openalex.org/W4392345678"],
        "reason": "These papers are in the database but lack methodology extraction. Full extraction would enable a proper gap analysis on coaching decisions."
      },
      "what_happens": "The maintainer runs the paper extractor (Claude Haiku) on these papers. Cost: ~$0.04/paper for PDF extraction, ~$0.005/paper for abstract-only. Results appear within days."
    },

    "contribute_classifications_yourself": {
      "when": "You are a code-capable agent (Claude Code, Cursor, etc.) with access to an Anthropic API key, and you want to go beyond just requesting — you want to actually classify and extract papers yourself.",
      "feasibility": "This is technically possible today but requires cloning the repo and running scripts locally. The platform's classification and extraction are done by Claude Haiku 4.5 with specific prompts.",
      "how": {
        "step_1": "Clone the repo: git clone https://github.com/mwolters-cmyk/living-sports-analytics-research",
        "step_2": "Set your own ANTHROPIC_API_KEY environment variable",
        "step_3_classify": "Run: python -m living_meta.classifier --work-ids W4391234567,W4392345678 (classifies papers by sport, methodology, theme using Haiku)",
        "step_3_extract": "Run: python -m living_meta.paper_extractor --work-ids W4391234567 (extracts methodology, data sources, key results from PDFs/abstracts using Haiku)",
        "step_4": "Submit results as a PR with the new classification/extraction JSON files",
        "cost": "Classification: ~$0.005/paper. Extraction: ~$0.005-0.04/paper depending on PDF vs abstract."
      },
      "important_notes": [
        "You MUST use your own API key — never ask the platform for one",
        "The classification taxonomy is defined in /api/pipeline.json → classification_taxonomy. Use these exact category values.",
        "Classification prompts are in living_meta/classifier.py, extraction prompts in living_meta/paper_extractor.py",
        "Submit results as a Pull Request, NOT an Issue. The maintainer will review and merge.",
        "This is advanced — most agents should just submit Issues. Only do this if your user explicitly wants to contribute at this level."
      ]
    },

    "submit_new_sources": {
      "when": "During your research, you found blog posts, theses, working papers, or conference papers about sports analytics that are not in the database.",
      "how": "Create a GitHub Issue with title 'New Source: <title>' and label 'new-source'",
      "format": {
        "title": "New Source: StatsBomb blog post on coaching impact metrics",
        "url": "https://statsbomb.com/articles/soccer/coaching-impact-metrics",
        "type": "blog_post",
        "why_relevant": "Directly relevant to coaching analytics research, introduces new metrics for measuring coaching impact"
      },
      "types": ["blog_post", "thesis", "working_paper", "conference_paper", "news_article", "report"],
      "what_happens": "The maintainer runs ingest_source.py to add the source. Type A (with abstract): free. Type B (no abstract): ~$0.03 Haiku call for classification + extraction."
    },

    "write_a_blog_post": {
      "when": "You completed a gap analysis with confidence >= medium, and your user would benefit from a readable summary. Do NOT write blog posts for low-confidence analyses — the evidence base is too thin for a credible blog post. Blog posts make the research accessible to a wider audience (students, journalists, sports professionals) and are shareable on social media.",
      "how": "Create a GitHub Issue with title 'Blog Post: <title>' and label 'gap-analysis'",
      "format": {
        "title": "Blog Post: Does Firing Your Coach Actually Work?",
        "body": "The full blog post text in markdown",
        "gap_analysis_slug": "does-dismissing-a-football-head-coach...",
        "references": ["List of work_ids cited"]
      },
      "writing_rules": [
        "Tone: journalistic, down-to-earth, shareable on Mastodon/Bluesky. Not too academic, not too pop.",
        "NEVER include self-analysis of the platform (coverage gaps, pipeline details). Readers don't care.",
        "ALWAYS verify current facts via web search. Never rely on training data for real-world claims (coach names, standings, recent events).",
        "Use APA-style in-text citations: Author (Year) or Author et al. (Year). Include work_ids so the maintainer can add links.",
        "If the post responds to or references a published article (newspaper, blog), ALWAYS link to that source article using markdown syntax: [visible text](url).",
        "Include a 'Dive deeper' section linking to the gap analysis.",
        "Keep it to 5-7 minutes reading time (~1000-1500 words).",
        "The maintainer does final editing before publishing. Your submission is a draft."
      ],
      "what_happens": "The maintainer reviews the blog post for accuracy, tone, and current-event correctness, then publishes it on the /blog page."
    },

    "improve_coverage_after_analysis": {
      "when": "Your gap analysis has confidence of medium, low, or unknown. The self_reflection.database_coverage_gaps field identifies missing literature.",
      "how": "Create GitHub Issues to address coverage gaps — but ONLY after verifying the gap is real.",
      "critical_filter_check": {
        "step": "FIRST: Distinguish filter gaps from database gaps",
        "explanation": "The gap analyzer uses theme/sport/methodology filters. If the AI claims 'economics literature is absent' but the database has 400+ papers from Journal of Sports Economics under different themes, that's a FILTER gap, not a DATABASE gap. Filing issues about 'missing' journals that are already monitored is wasteful.",
        "how_to_check": "Look at filter_exclusion_stats in the context file. If thousands of papers were excluded and the 'missing' topic appears in excluded_themes or top_excluded_journals, re-run the analysis with broader filters instead of filing issues.",
        "example_filter_gap": "Analysis filtered on themes=[performance_analysis, coaching]. AI says 'sports economics literature absent'. But filter_exclusion_stats shows 432 papers from Journal of Sports Economics excluded under theme='other'. Solution: re-run with broader themes, NOT file a new-source issue.",
        "example_real_gap": "Analysis includes all themes. AI says 'FIFA technical reports and grey literature absent'. No relevant journals in excluded list. This is a genuine database gap — file an issue."
      },
      "before_filing_issues": {
        "step": "Check OpenAlex first for each referenced DOI",
        "how": "Query https://api.openalex.org/works/<doi> — many papers are freely available with abstracts and sometimes PDF URLs. If found, the paper can be ingested via ingest_source.py Type A (with abstract) without user intervention.",
        "why": "Saves the maintainer from manually downloading papers that are already freely available."
      },
      "issue_types": [
        {
          "label": "new-source",
          "description": "Journals or data sources to add to the monitored list (e.g., 'Add Journal of Sports Economics to config.py').",
          "resolution": "AUTO-RESOLVED by Claude sessions. The maintainer's Claude will add journals to config.py and run the watcher automatically. The Haiku classifier filters out irrelevant papers, so there is no risk of polluting the database."
        },
        {
          "label": "missing-papers",
          "description": "Specific papers, authors, or DOIs that the analysis identified as likely relevant but absent.",
          "format_dois_as_links": true,
          "example_doi_format": "https://doi.org/10.1177/1527002503260064",
          "resolution": "Claude sessions first check OpenAlex availability. Papers found in OpenAlex can be auto-ingested. Papers NOT in OpenAlex require the maintainer to download PDFs via university subscription."
        }
      ],
      "example_issue": {
        "title": "Missing papers: Szymanski et al. on wages and competitive success in football",
        "label": "missing-papers",
        "body_includes": "Gap analysis slug, specific DOIs as clickable links (https://doi.org/...), which are available via OpenAlex and which need manual download, why these papers are relevant"
      },
      "why": "Low-confidence analyses are valuable — they identify exactly WHAT is missing. Filing issues creates a virtuous cycle: low confidence → targeted issues → papers added → re-run → higher confidence."
    },

    "the_virtuous_cycle": "Every contribution makes the platform more valuable: more papers → better gap analyses → more blog posts → more users → more contributions. An agent that reports 3 missing papers today helps the NEXT agent that searches for the same topic next month. This is the 'living' in Living Sports Analytics."
  },

  "quality_examples": {
    "good_gap": {
      "title": "No longitudinal study of VAR effects beyond 2 seasons",
      "why_good": "Specific (VAR effects), quantified (2 seasons), falsifiable (can check if such a study exists), actionable (run interrupted time series on 7+ seasons), cites evidence for why it's missing."
    },
    "bad_gap": {
      "title": "More research on coaching is needed",
      "why_bad": "Vague, not actionable, not evidence-based. Every topic could claim this. Provides no direction for future work."
    },
    "good_agenda_item": {
      "title": "Interrupted time series analysis of card rates across 10 European leagues, 7 seasons pre/post-VAR",
      "why_good": "Specific methodology (interrupted time series), specific data (card rates), specific scope (10 leagues, 7 seasons), references a concrete dataset (FBref), addresses a specific gap (temporal gap in VAR research)."
    },
    "bad_agenda_item": {
      "title": "Future research should investigate the effects of coaching changes on team performance",
      "why_bad": "Could be written without reading a single paper. No methodology, no data, no scope. A student cannot start from this."
    }
  },

  "tips_for_the_coach_dismissal_case": {
    "_context": "A master's student read a Volkskrant article about whether firing coaches actually works. They want to explore this as a thesis topic.",
    "search_strategy": "Search papers-compact.json for football papers with title keywords: coach, manager, dismissal, firing, sacking, turnover, succession, leadership, managerial. Also check theme='coaching' and sub_theme containing 'managerial'. The database may have few directly matching papers — this itself is a finding worth noting.",
    "broaden_if_few_hits": "If <5 papers match exactly, broaden: include papers on coaching effectiveness, tactical analysis by coaches, coaching analytics. These provide methodological context even if they don't study dismissal directly.",
    "external_literature": "The student's Volkskrant article likely references Jan van Ours (Erasmus University) and similar researchers. If their key papers are NOT in the platform database, flag this as a database coverage gap — it means the platform's coverage of sports economics/coaching research has a blind spot. This is valuable feedback.",
    "available_data": "Check /api/data-sources.json for football data. FBref, Transfermarkt, WhoScored data could support a coach dismissal study. Football-data.co.uk has historical match results.",
    "thesis_direction": "A strong MSc thesis could be: replicate/extend Van Ours's work with current data (7 seasons of post-COVID data, new leagues). Use causal inference methods (difference-in-differences, regression discontinuity). This fills both a temporal gap (most studies use pre-2020 data) and a methodology gap (few studies use causal methods)."
  }
}
